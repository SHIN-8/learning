# 値オブジェクト(Value Object)

値オブジェクトはドメインオブジェクトのひとつで、システム固有の値を表現したオブジェクトのことです。

## 具体例

「名前」をプリミティブな値（型）と値オブジェクトで表現してみます。

例）プリミティブな値で表現した場合

```ts
const name = 'John'; // ただの文字列
```

例）値オブジェクトで表現した場合

```ts
class Name {
    private readonly value: string

    constructor(value: string) {
        this.value = value
    }
}

const name = new Name('John') // ドメインのルールに則った「名前」であることがわかる
```

## 値オブジェクトにすると何が嬉しいのか

値オブジェクトを採用するモチベーションとして、参考図書では以下が紹介されています。

> - 表現力を増す
> - 不正な値を存在させない
> - 誤った代入を防ぐ
> - ロジックの散在を防ぐ

`./src` 以下のコードで解説します。

いずれのポイントにも共通する大きな利点は **「自己文書化」・「コードがドキュメント化する」** ということです。

## ドメインに基づいたふるまいをもたせる

値オブジェクトはドメインオブジェクトなので、ドメインに基づいたふるまいが定義できます（`Name` クラスの `getInitials()` を参照）。

## 値オブジェクトの性質

代表的な性質は以下の 3 つ。

- 不変(immutable)
- 交換は可能
- 等価性によって比較される

### 不変(immutable)

- 値オブジェクトは数値の "1" や文字の "a" などと同様「値」であるため変更されることはない
- 「値」であるため変更されることはない

### 交換可能

- 値オブジェクトが代入された変数に別の値オブジェクトを再代入することは可能

### 等価性によって比較される

- `0 === 0` のように値は比較できる
- 値オブジェクトも上記同様に比較される（ように実装するべき）
- ただし比較演算子による比較はできないため、そのためのメソッドを用意する(`Name` クラスの `equals()` を参照)

## 値オブジェクトにするひとつの基準

ドメインモデルを値オブジェクトにするのはすぐ理解できますが、他の値もすべて値オブジェクトすべきかは判断が分かれます。

参考図書ではひとつの基準として以下を紹介しています。

> 「そこにルールが存在しているか」という点と「それ単体で取り扱いたいか」という点を重要視しています。

### ルールが存在しているか

たとえば本リポジトリでは、「名前」は 1 文字以上の半角英字であることがルールとして `Name` クラスを定義しています。

### それ単体で取り扱いたいか

たとえば新たに「姓名」を取り扱うことになった場合、`FirstName` クラスと `LastName` クラスを作るかどうかを判断します。

- プログラム上で「姓」と「名」を分けて扱いたい場合→作る
- 分けなくていい場合→ どちらも `Name` クラスでインスタンス化する
